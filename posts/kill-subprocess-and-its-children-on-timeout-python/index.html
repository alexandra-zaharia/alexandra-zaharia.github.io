<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Kill a Python subprocess and its children when a timeout is reached" /><meta name="author" content="Alexandra Zaharia" /><meta property="og:locale" content="en" /><meta name="description" content="Suppose a Python script needs to launch an external command. This can be done using the subprocess module in one of two ways:" /><meta property="og:description" content="Suppose a Python script needs to launch an external command. This can be done using the subprocess module in one of two ways:" /><link rel="canonical" href="https://alexandra-zaharia.github.io/posts/kill-subprocess-and-its-children-on-timeout-python/" /><meta property="og:url" content="https://alexandra-zaharia.github.io/posts/kill-subprocess-and-its-children-on-timeout-python/" /><meta property="og:site_name" content="Alexandra Zaharia" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-05T01:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Kill a Python subprocess and its children when a timeout is reached" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Alexandra Zaharia" /><meta name="google-site-verification" content="mlwABpnF22MCyeNCQoei9VdIPvqy_uV7b4v_vArTxXM" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Alexandra Zaharia"},"dateModified":"2021-07-05T01:00:00+02:00","datePublished":"2021-07-05T01:00:00+02:00","description":"Suppose a Python script needs to launch an external command. This can be done using the subprocess module in one of two ways:","headline":"Kill a Python subprocess and its children when a timeout is reached","mainEntityOfPage":{"@type":"WebPage","@id":"https://alexandra-zaharia.github.io/posts/kill-subprocess-and-its-children-on-timeout-python/"},"url":"https://alexandra-zaharia.github.io/posts/kill-subprocess-and-its-children-on-timeout-python/"}</script><title>Kill a Python subprocess and its children when a timeout is reached | Alexandra Zaharia</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Alexandra Zaharia"><meta name="application-name" content="Alexandra Zaharia"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en">
<div class="profile-wrapper text-center">
<div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/site/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a>
</div>
<div class="site-title mt-3"> <a href="/">Alexandra Zaharia</a>
</div>
<div class="site-subtitle font-italic">My dev blog</div>
</div>
<ul class="w-100">
<li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a>
</li>
<li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a>
</li>
<li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a>
</li>
<li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a>
</li>
<li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a>
</li>
<li class="nav-item"> <a href="/resume/" class="nav-link"> <i class="fa-fw fas fa-user ml-xl-3 mr-xl-3 unloaded"></i> <span>RESUME</span> </a>
</li>
</ul>
<div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/alexandra-zaharia" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/alexandra-zaharia-fr" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href%20=%20'mailto:'%20+%20['contact','alexandra-zaharia.org'].join('@')" aria-label="email"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss"> <i class="fas fa-rss"></i> </a>
</div>
</div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Kill a Python subprocess and its children when a timeout is reached</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div>
<i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel">Cancel</span>
</div></div><div id="main-wrapper">
<div id="main">
<div class="row">
<div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
<h1 data-toc-skip>Kill a Python subprocess and its children when a timeout is reached</h1>
<div class="post-meta text-muted d-flex flex-column">
<div> <span class="semi-bold"> Alexandra Zaharia </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Jul 5, 2021, 1:00 AM +0200">Jul 5, 2021<i class="unloaded">2021-07-05T01:00:00+02:00</i> </span>
</div>
<div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="836 words">4 min read</span>
</div>
</div>
<div class="post-content">
<p>Suppose a Python script needs to launch an external command. This can be done using the <a href="https://docs.python.org/3/library/subprocess.html"><code class="language-plaintext highlighter-rouge">subprocess</code></a> module in one of two ways:</p>
<ul>
<li>either use the “convenience” function <code class="language-plaintext highlighter-rouge">subprocess.run()</code>
</li>
<li>or use the more flexible <code class="language-plaintext highlighter-rouge">Popen</code> interface</li>
</ul>
<h2 id="stopping-a-subprocess-on-timeout">Stopping a subprocess on timeout</h2>
<p>The “convenience” function <code class="language-plaintext highlighter-rouge">subprocess.run()</code> allows to do quite a number of useful things, such as capturing output, checking the external command’s return code or setting a timeout, among others.</p>
<p>If we are simply interested in stopping the execution of the external command after a given timeout has been reached, it is sufficient to <code class="language-plaintext highlighter-rouge">subprocess.run()</code> the command and catch the <code class="language-plaintext highlighter-rouge">TimeoutExpired</code> exception if it is raised:</p>
<div class="language-python highlighter-rouge">
<div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td>
<td class="rouge-code"><pre><span class="kn">import</span> <span class="n">subprocess</span>

<span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">/path/to/cmd</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">arg1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">arg2</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># the external command to run
</span><span class="n">timeout_s</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># how many seconds to wait 
</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout_s</span><span class="p">)</span>
<span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Timeout for </span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s"> (</span><span class="si">{</span><span class="n">timeout_s</span><span class="si">}</span><span class="s">s) expired</span><span class="sh">'</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<h2 id="stopping-a-subprocess-and-its-children-on-timeout">Stopping a subprocess and its children on timeout</h2>
<p>The situation gets more complicated when the external command may launch one or several child processes. In order to be able to stop the child processes as well as the parent, it is necessary to use the <code class="language-plaintext highlighter-rouge">Popen</code> constructor.</p>
<blockquote><p><strong>Note:</strong> The following only applies to UNIX-like operating systems. (Read: it won’t work on Windows.)</p></blockquote>
<p>The reason for using the <code class="language-plaintext highlighter-rouge">Popen</code> constructor for this scenario is that it can be instructed to launch a new <em>session</em> for the external command. Then, the whole <em>process group</em> belonging to the external command can be terminated on timeout. A <strong>process group</strong> is simply a group of processes that can be controlled at once (via <a href="https://en.wikipedia.org/wiki/Signal_(IPC)">signals</a>), while a <strong>session</strong> is a collection of process groups. Here are the official <a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html">definitions</a>, taken from the <a href="https://pubs.opengroup.org/onlinepubs/9699919799/">POSIX.1-2008 standard</a>:</p>
<blockquote><p><strong>3.296 Process Group</strong> - A collection of processes that permits the signaling of related processes. Each process in the system is a member of a process group that is identified by a process group ID. A newly created process joins the process group of its creator.</p></blockquote>
<blockquote><p><strong>3.343 Session</strong> - A collection of process groups established for job control purposes. Each process group is a member of a session. A process is considered to be a member of the session of which its process group is a member. A newly created process joins the session of its creator. A process can alter its session membership; see <code class="language-plaintext highlighter-rouge">setsid()</code>. There can be multiple process groups in the same session.</p></blockquote>
<h3 id="the-reason-for-using-a-session-instead-of-a-process-group">The reason for using a session instead of a process group</h3>
<p>Reading the above definitions, one may wonder why should we bother with creating a new session instead of simply using a new process group for the external command. That’s an excellent question! It is technically possible, but not advisable. In order to create a process group, we’d need to call <code class="language-plaintext highlighter-rouge">os.setpgrp()</code> (which uses the <a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/setpgrp.html"><code class="language-plaintext highlighter-rouge">setpgrp()</code></a> system call). However, there are two problems with this approach:</p>
<ul>
<li>
<code class="language-plaintext highlighter-rouge">setpgrp()</code> is marked as obsolete and may be removed in future versions (check the <code class="language-plaintext highlighter-rouge">man</code> page);</li>
<li>the only way to call <code class="language-plaintext highlighter-rouge">os.setpgrp()</code> from within the <code class="language-plaintext highlighter-rouge">Popen</code> constructor is to pass it to the <code class="language-plaintext highlighter-rouge">preexec_fn</code> parameter, which is <em>not</em> thread-safe.</li>
</ul>
<p>The Python documentation for <a href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen"><code class="language-plaintext highlighter-rouge">Popen()</code></a> states the following:</p>
<blockquote><p><strong>Warning:</strong> The <code class="language-plaintext highlighter-rouge">preexec_fn</code> parameter is not safe to use in the presence of threads in your application. The child process could deadlock before <code class="language-plaintext highlighter-rouge">exec</code> is called. If you must use it, keep it trivial! Minimize the number of libraries you call into.</p></blockquote>
<p>In the note following the warning, it is mentioned that:</p>
<blockquote><p>The <code class="language-plaintext highlighter-rouge">start_new_session</code> parameter can take the place of a previously common use of <code class="language-plaintext highlighter-rouge">preexec_fn</code> to call <code class="language-plaintext highlighter-rouge">os.setsid()</code> in the child.</p></blockquote>
<p>The workaround, therefore, is to simply create a new session by setting the <code class="language-plaintext highlighter-rouge">start_new_session</code> argument of the <code class="language-plaintext highlighter-rouge">Popen</code> constructor to <code class="language-plaintext highlighter-rouge">True</code>. According to the Python documentation, it is the equivalent of using <code class="language-plaintext highlighter-rouge">preexec_fn=os.setsid</code> (based on the <a href="https://pubs.opengroup.org/onlinepubs/009604599/functions/setsid.html"><code class="language-plaintext highlighter-rouge">setsid()</code></a> system call), but without the un-thread-safe warning.</p>
<h3 id="implementation">Implementation</h3>
<p>With all the above explanations, the implementation is straight-forward:</p>
<div class="language-python highlighter-rouge">
<div class="code-header"> <span text-data=" Python "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td>
<td class="rouge-code"><pre><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="n">subprocess</span>
<span class="kn">import</span> <span class="n">sys</span>

<span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">/path/to/cmd</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">arg1</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">arg2</span><span class="sh">'</span><span class="p">]</span>  <span class="c1"># the external command to run
</span><span class="n">timeout_s</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># how many seconds to wait 
</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="nc">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">start_new_session</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">p</span><span class="p">.</span><span class="nf">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout_s</span><span class="p">)</span>
<span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Timeout for </span><span class="si">{</span><span class="n">cmd</span><span class="si">}</span><span class="s"> (</span><span class="si">{</span><span class="n">timeout_s</span><span class="si">}</span><span class="s">s) expired</span><span class="sh">'</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Terminating the whole process group...</span><span class="sh">'</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="p">.</span><span class="n">stderr</span><span class="p">)</span>
    <span class="n">os</span><span class="p">.</span><span class="nf">killpg</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">getpgid</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">pid</span><span class="p">),</span> <span class="n">signal</span><span class="p">.</span><span class="n">SIGTERM</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>The <code class="language-plaintext highlighter-rouge">Popen</code> interface is different than that of the convenience <code class="language-plaintext highlighter-rouge">subprocess.run()</code> function. The timeout needs to be specified in <code class="language-plaintext highlighter-rouge">Popen.wait()</code>. If you want to capture <code class="language-plaintext highlighter-rouge">stdout</code> and <code class="language-plaintext highlighter-rouge">stderr</code>, you need to pass them to the <code class="language-plaintext highlighter-rouge">Popen</code> constructor as <code class="language-plaintext highlighter-rouge">subprocess.PIPE</code> and then use <code class="language-plaintext highlighter-rouge">Popen.communicate()</code>. Regardless of the differences, whatever can be done with <code class="language-plaintext highlighter-rouge">subprocess.run()</code> can also be achieved with the <code class="language-plaintext highlighter-rouge">Popen</code> constructor.</p>
<p>When the timeout set in <code class="language-plaintext highlighter-rouge">Popen.wait()</code> has elapsed, a <code class="language-plaintext highlighter-rouge">TimeoutExpired</code> exception is raised. Then, in line 15, we send a SIGTERM to the whole process group (<code class="language-plaintext highlighter-rouge">os.killpg()</code>) of the external command (<code class="language-plaintext highlighter-rouge">os.getpgid(p.pid)</code>).</p>
<p>That’s it. Happy infanticide! (Err… I was referring to child processes <img class="emoji" title=":grin:" alt=":grin:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f601.png" height="20" width="20">)</p>
<h2 id="further-reading">Further reading</h2>
<ul>
<li>
<a href="https://docs.python.org/3/library/subprocess.html"><code class="language-plaintext highlighter-rouge">subprocess</code></a> (Python documentation)</li>
<li>
<a href="https://docs.python.org/3/library/signal.html"><code class="language-plaintext highlighter-rouge">signal</code></a> (Python documentation)</li>
<li>
<a href="https://en.wikipedia.org/wiki/Signal_(IPC)">Signals</a> (Wikipedia)</li>
<li><a href="https://pubs.opengroup.org/onlinepubs/9699919799/">POSIX.1-2008 standard</a></li>
<li><a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html">POSIX.1-2008 definitions</a></li>
</ul>
</div>
<div class="post-tail-wrapper text-muted">
<div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href="/categories/python/">Python</a>, <a href="/categories/subprocess/">subprocess</a>, <a href="/categories/timeout/">timeout</a>
</div>
<div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/python/" class="post-tag no-text-decoration">python</a> <a href="/tags/process/" class="post-tag no-text-decoration">process</a> <a href="/tags/subprocess/" class="post-tag no-text-decoration">subprocess</a> <a href="/tags/signal/" class="post-tag no-text-decoration">signal</a>
</div>
<div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
<div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div>
<div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Kill%20a%20Python%20subprocess%20and%20its%20children%20when%20a%20timeout%20is%20reached%20-%20Alexandra%20Zaharia&amp;url=https://alexandra-zaharia.github.io/posts/kill-subprocess-and-its-children-on-timeout-python/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Kill%20a%20Python%20subprocess%20and%20its%20children%20when%20a%20timeout%20is%20reached%20-%20Alexandra%20Zaharia&amp;u=https://alexandra-zaharia.github.io/posts/kill-subprocess-and-its-children-on-timeout-python/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Kill%20a%20Python%20subprocess%20and%20its%20children%20when%20a%20timeout%20is%20reached%20-%20Alexandra%20Zaharia&amp;url=https://alexandra-zaharia.github.io/posts/kill-subprocess-and-its-children-on-timeout-python/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=Kill%20a%20Python%20subprocess%20and%20its%20children%20when%20a%20timeout%20is%20reached%20-%20Alexandra%20Zaharia&amp;u=https://alexandra-zaharia.github.io/posts/kill-subprocess-and-its-children-on-timeout-python/" data-toggle="tooltip" data-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews"> <i class="fa-fw fab fa-hacker-news"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://alexandra-zaharia.github.io/posts/kill-subprocess-and-its-children-on-timeout-python/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span>
</div>
</div>
</div>
</div></div>
<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down">
<div class="access">
<div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2">
<li><a href="/posts/connect-bluetooth-headset-automatically-linux/">Connect a bluetooth headset automatically in Linux</a></li>
<li><a href="/posts/concurrency-crash-course-part-1/">Concurrency crash course. Part 1: Terminology, usage and pitfalls</a></li>
<li><a href="/posts/my-2021-dev-retrospective/">My 2021 dev retrospective</a></li>
<li><a href="/posts/how-to-stop-a-python-thread-cleanly/">How to stop a Python thread cleanly</a></li>
<li><a href="/posts/how-to-return-a-result-from-a-python-thread/">How to return a result from a Python thread</a></li>
</ul>
</div>
<div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/c-c/">c/c++</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/binary/">binary</a> <a class="post-tag" href="/tags/bluetooth/">bluetooth</a> <a class="post-tag" href="/tags/manjaro/">manjaro</a> <a class="post-tag" href="/tags/mercurial/">mercurial</a> <a class="post-tag" href="/tags/thread/">thread</a> <a class="post-tag" href="/tags/version-control/">version control</a>
</div>
</div>
</div>
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav>
</div>
</div>
</div>
<div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
<div id="related-posts" class="mt-5 mb-2 mb-sm-4">
<h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3>
<div class="card-deck mb-4">
<div class="card"> <a href="/posts/function-timeout-in-python-signal/"><div class="card-body"> <span class="timeago small">Feb 5, 2016<i class="unloaded">2016-02-05T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Function timeout in Python using the signal module</h3>
<div class="text-muted small"><p> The problem Sometimes you may want to impose a timeout on a Python function. Why would you want to do such a thing? Let’s say you’re computing something but you know there are some hopeless scenar...</p></div>
</div></a>
</div>
<div class="card"> <a href="/posts/run-python-script-as-subprocess-with-multiprocessing/"><div class="card-body"> <span class="timeago small">Apr 17, 2019<i class="unloaded">2019-04-17T01:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Run a Python script as a subprocess with the multiprocessing module</h3>
<div class="text-muted small"><p> The problem Suppose you have a Python script worker.py performing some long computation. Also suppose you need to perform these computations several times for different input data. If all the comp...</p></div>
</div></a>
</div>
<div class="card"> <a href="/posts/multiprocessing-in-python-with-shared-resources/"><div class="card-body"> <span class="timeago small">Apr 17, 2019<i class="unloaded">2019-04-17T02:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Multiprocessing in Python with shared resources</h3>
<div class="text-muted small"><p> The problem In the previous post on parallelism in Python, we have seen how an external Python script performing a long computation can be ran in parallel using Python’s multiprocessing module. If...</p></div>
</div></a>
</div>
</div>
</div>
<div class="post-navigation d-flex justify-content-between"> <a href="/posts/stopping-python-systemd-service-cleanly/" class="btn btn-outline-primary" prompt="Older"><p>Stopping a Python systemd service cleanly</p></a> <a href="/posts/how-to-stop-a-python-thread-cleanly/" class="btn btn-outline-primary" prompt="Newer"><p>How to stop a Python thread cleanly</p></a>
</div>
<div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div>
<script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://alexandra-zaharia.github.io/posts/kill-subprocess-and-its-children-on-timeout-python/'; this.page.identifier = '/posts/kill-subprocess-and-its-children-on-timeout-python/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://azc.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (modeToggle !== null) { modeToggle.addEventListener('click', reloadDisqus); window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script>
</div></div></div>
<footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center">
<div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/alexandra-zaharia">Alexandra Zaharia</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div>
<div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div>
</div></footer>
</div>
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content">
<div id="search-hints">
<h4 class="text-muted mb-4">Trending Tags</h4>
<a class="post-tag" href="/tags/c-c/">c/c++</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/algorithms/">algorithms</a> <a class="post-tag" href="/tags/binary/">binary</a> <a class="post-tag" href="/tags/bluetooth/">bluetooth</a> <a class="post-tag" href="/tags/manjaro/">manjaro</a> <a class="post-tag" href="/tags/mercurial/">mercurial</a> <a class="post-tag" href="/tags/thread/">thread</a> <a class="post-tag" href="/tags/version-control/">version control</a>
</div>
<div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
</div></div>
</div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-Z7ZY7JRFQJ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-Z7ZY7JRFQJ'); }); </script>
